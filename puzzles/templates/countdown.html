{% extends "base.html" %}
{% load i18n %}
{% block content %}

<h1 id="countdown" style="text-align: center"></h1>

{% if team %}
    <div align="center">
        <form method="post" action="{% url 'claim_start' %}">
            {% csrf_token %}
            <button class="btn btn-dark" type="submit" id="claim_start">立刻开始</button>
        </form>
    </div>
{% else %}
    <div>
        <p>请登录以访问本页面。</p>
    </div>
{% endif %}

<script>
var start = new Date('{{ start.isoformat }}');
setInterval(function() {
    var diff = (start - new Date) / 1000;
    var elt = document.getElementById('countdown');
    if (diff >= 0) {
        var sec = diff % 60 | 0;
        if (sec < 10) {
            sec = '0' + sec;
        }
        var min_ = diff / 60 | 0;
        var min = min_ % 60 | 0;
        if (min < 10) {
            min = '0' + min;
        }
        var hrs = min_ / 60 | 0;
        elt.textContent = hrs + ':' + min + ':' + sec;
    } else {
        elt.textContent = '活动开始倒计时已结束，请刷新页面。';
    }
}, 100);
</script>

{% endblock %}
