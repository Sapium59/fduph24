{% extends "base.html" %}
{% load i18n %}
{% load puzzle_tags %}

{% block top-left-actions %}
{% if is_superuser %}
<a href="{% url 'admin:puzzles_erratum_add' %}" class="btn">新建更新公告</a>
{% endif %}
{% endblock %}

{% block content %}
<h1>更新公告</h1>
<main>
    {% for erratum in visible_errata %}
    {% if erratum.updates_text %}
    <div class="puzzle-erratum">
        {% if not erratum.published %}
        <strong>[<a href="{% url 'admin:puzzles_erratum_change' erratum.id %}">尚未发布</a>]</strong>
        {% endif %}
        {% format_time erratum.timestamp "DATE_AT_TIME" as erratum_time %}
        {% blocktranslate %}On {{ erratum_time }}, {% endblocktranslate %}
        {{ erratum.formatted_updates_text|safe }}
        {% if is_superuser and erratum.puzzle %}
        <details>
            <summary>{% translate "Emails:" %}</summary>
            <textarea>{{ erratum.get_emails|join:', ' }}</textarea>
        </details>
        {% endif %}
    </div>
    {% endif %}
    {% endfor %}
</main>
{% endblock %}
